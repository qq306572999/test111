<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>一线吃瓜网</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="swiper.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- 整合所有样式：长条触发按钮 + QQ式聊天 -->
    <style>
        /* 原页面轮播样式 */
        .profile{
            position: relative; 
            overflow: hidden;
            border: 4px solid rgba(255,255,255,.3);
            border-radius: 10px;
        }
        .profile img{
            width: 100% !important;
            height: auto !important;
            display: block;
        }
        .profile .swiper-button-next,
        .profile .swiper-button-prev{
            color: #fff;
        }
        .swiper-button-next:after, 
        .swiper-button-prev:after{
            font-size: 20px;
        }
        .fgt{height: 20px;}
        .swiper{padding-bottom: 25px;}
        .main-link{
            width: 60%; 
            margin:10px auto;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            text-decoration: none;
        }
        .pr_wbnr h3{
            font-size: 12px; 
            line-height: 22px; 
            color: #333;
            text-align: left;
        }

        /* 1. AI机器人触发按钮：长条小框框样式 */
        .service-trigger-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 120px; /* 长条宽度 */
            height: 40px; /* 高度 */
            background: #0084ff;
            border-radius: 6px; /* 小圆角，非圆形 */
            box-shadow: 0 2px 8px rgba(0,132,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            z-index: 9998;
            transition: all 0.3s;
            gap: 6px; /* 图标与文字间距 */
        }
        .service-trigger-btn:hover {
            background: #0073e6;
            box-shadow: 0 3px 10px rgba(0,132,255,0.4);
        }
        .service-trigger-btn i {
            font-size: 16px; /* AI机器人图标大小 */
        }

        /* 2. 客服弹窗 */
        .service-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 380px;
            border: 1px solid #eee;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background: #fff;
            overflow: hidden;
            font-family: "Microsoft YaHei", sans-serif;
            display: none;
            z-index: 9999;
            flex-direction: column;
        }

        /* 3. 弹窗头部 */
        .popup-header {
            padding: 12px 16px;
            background: #f5f5f5;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-left {
            display: flex;
            align-items: center;
        }
        .service-name {
            font-weight: 600;
            color: #333;
            margin-right: 8px;
            font-size: 15px;
        }
        .online-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4cd964;
            margin-right: 4px;
            animation: blink 1.5s infinite;
        }
        .status-text {
            font-size: 12px;
            color: #666;
        }
        .popup-close {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #999;
            transition: all 0.2s;
        }
        .popup-close:hover {
            background: #f0f0f0;
            color: #333;
        }

        /* 4. QQ式聊天布局 */
        .message-container {
            height: 400px;
            padding: 16px;
            overflow-y: auto;
            background: #fafafa;
            flex: 1;
        }
        .message-row {
            margin-bottom: 16px;
            display: flex;
            clear: both;
        }
        .service-message-row {
            align-items: flex-start;
        }
        .user-message-row {
            flex-direction: row-reverse;
            align-items: flex-start;
        }

        /* 小雨头像（b1.png） */
        .service-avatar-img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
            border: 1px solid #eee;
        }
        .user-avatar-img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-left: 8px;
            border: 1px solid #eee;
            display: none;
        }

        /* 消息气泡 */
        .message-bubble {
            max-width: 75%;
            padding: 10px 14px;
            border-radius: 18px;
            line-height: 1.5;
            font-size: 14px;
            position: relative;
        }
        .service-bubble {
            background: #e5f3ff;
            color: #333;
            border-top-left-radius: 4px;
        }
        .service-bubble::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 6px solid #e5f3ff;
        }
        .user-bubble {
            background: #0084ff;
            color: #fff;
            border-top-right-radius: 4px;
        }
        .user-bubble::before {
            content: '';
            position: absolute;
            right: -6px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-left: 6px solid #0084ff;
        }

        /* 5. 用户上传图片预览 */
        .user-images {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
            max-width: 75%;
            margin-left: auto;
        }
        .user-images img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #eee;
        }

        /* 6. 底部上传区域 */
        .input-area {
            padding: 12px 16px;
            border-top: 1px solid #eee;
            background: #fff;
        }
        .img-upload {
            display: inline-block;
            padding: 8px 16px;
            background: #0084ff;
            color: #fff;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }
        .img-upload:hover {
            background: #0073e6;
        }
        #img-input {
            display: none;
        }
        .upload-tip {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
            text-align: center;
        }
        .warning-tip {
            font-size: 12px;
            color: #ff4d4f;
            margin-top: 4px;
            text-align: center;
            display: none;
        }

        /* 在线状态闪烁动画 */
        @keyframes blink {
            0%,100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 背景动画 -->
        <div class="background-animation">
            <div class="floating-shape shape-1"></div>
            <div class="floating-shape shape-2"></div>
            <div class="floating-shape shape-3"></div>
            <div class="floating-shape"></div>
            <div class="floating-shape"></div>
        </div>

        <!-- 主要内容 -->
        <main class="profile-container">
            <div class="shimmer-line"></div>
            
            <!-- 个人信息区域 -->
            <section class="profile-header">
                <div class="avatar-container">
                    <img src="Tx.jpg" alt="头像" class="avatar" id="avatarImg">
                    <div class="avatar-border"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="admin-secret-entry" id="adminSecretEntry">
                        <i class="fas fa-cog"></i>
                    </div>
                </div>
                
                <h1 class="profile-name" id="profileName">www.636.icu</h1>
                <p class="profile-bio" id="profileBio" style="font-size: 28px; color: #fff;">一线吃瓜网</p>

                <!-- 第一组轮播（a1-a5） -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup1">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a1.png" style="width: 100%;" alt="第一组图1"/></div>
                            <div class="swiper-slide"><img src="a2.png" style="width: 100%;" alt="第一组图2"/></div>
                            <div class="swiper-slide"><img src="a3.png" style="width: 100%;" alt="第一组图3"/></div>
                            <div class="swiper-slide"><img src="a4.png" style="width: 100%;" alt="第一组图4"/></div>
                            <div class="swiper-slide"><img src="a5.png" style="width: 100%;" alt="第一组图5"/></div>
                        </div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-1" data-analytics="官网">
                            <span class="watermelon-icon">🍉</span>
                            <span>热门吃瓜</span>
                            <b>获取<br />资源</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- 第二组轮播（a6-a10） -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup2">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a6.png" style="width: 100%;" alt="第二组图1"/></div>
                            <div class="swiper-slide"><img src="a7.png" style="width: 100%;" alt="第二组图2"/></div>
                            <div class="swiper-slide"><img src="a8.png" style="width: 100%;" alt="第二组图3"/></div>
                            <div class="swiper-slide"><img src="a9.png" style="width: 100%;" alt="第二组图4"/></div>
                            <div class="swiper-slide"><img src="a10.png" style="width: 100%;" alt="第二组图5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-2" data-analytics="作品集">
                            <i class="fas fa-cloud"></i>
                            <span>反差女神</span>
                            <b>获取<br />资源</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- 第三组轮播（a11-a15） -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup3">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a11.png" style="width: 100%;" alt="第三组图1"/></div>
                            <div class="swiper-slide"><img src="a12.png" style="width: 100%;" alt="第三组图2"/></div>
                            <div class="swiper-slide"><img src="a13.png" style="width: 100%;" alt="第三组图3"/></div>
                            <div class="swiper-slide"><img src="a14.png" style="width: 100%;" alt="第三组图4"/></div>
                            <div class="swiper-slide"><img src="a15.png" style="width: 100%;" alt="第三组图5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-3" data-analytics="博客">
                            <span class="penguin-icon">🧭</span>
                            <span>silk/女性向</span>
                            <b>获取<br />资源</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- 第四组轮播（a16-a20） -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup4">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a16.png" style="width: 100%;" alt="第四组图1"/></div>
                            <div class="swiper-slide"><img src="a17.png" style="width: 100%;" alt="第四组图2"/></div>
                            <div class="swiper-slide"><img src="a18.png" style="width: 100%;" alt="第四组图3"/></div>
                            <div class="swiper-slide"><img src="a19.png" style="width: 100%;" alt="第四组图4"/></div>
                            <div class="swiper-slide"><img src="a20.png" style="width: 100%;" alt="第四组图5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-4" data-analytics="往期">
                            <i class="fas fa-history"></i>
                            <span>绅士游戏</span>
                            <b>获取<br />资源</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
            </section>

            <!-- 二维码区域 -->
            <section class="qr-section">
                <div class="qr-container">
                    <p class="qr-text">一线吃瓜网</p>
                    <div class="pr_wbnr">
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">一线吃瓜网攻克各种资源难题，带来最新最快最全的吃瓜黑料啊啊啊啊</h3>	
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">明星、网红、女神、校园…………</h3>	
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">让您不错过任何一个热门大瓜</h3>	
                        <p style="text-align: right; color: #ff0000;font-weight: bold; font-size: 12px; margin-top: 10px;">非法律允许地区以及18岁以下用户禁止访问！</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- 已删除：底部工具栏的分享按钮 -->

        <!-- 已删除：分享模态框 -->
    </div>

    <!-- 1. AI机器人触发按钮：长条样式（图标+文字） -->
    <div class="service-trigger-btn" id="serviceTriggerBtn">
        <i class="fas fa-robot"></i> <!-- AI机器人图标 -->
        <span>AI机器人</span> <!-- 文字 -->
    </div>

    <!-- 2. 小雨客服弹窗 -->
    <div class="service-popup" id="servicePopup">
        <!-- 弹窗头部 -->
        <div class="popup-header">
            <div class="header-left">
                <div class="service-name">小雨</div>
                <div class="online-status"></div>
                <div class="status-text">在线中</div>
            </div>
            <div class="popup-close" id="popupClose">
                <i class="fas fa-times"></i>
            </div>
        </div>

        <!-- 消息区域：初始小雨对话（带b1.png头像） -->
        <div class="message-container" id="messageContainer">
            <div class="message-row service-message-row">
                <img src="b1.png" alt="小雨头像" class="service-avatar-img">
                <div class="message-bubble service-bubble">
                    请将评论的规范截图都发送给我，审核通过后我会发送所有资源的跳转页链接~<br>
                    注意：不规范截图和发送重复的截图将重置进度，所以是一定不能投机取巧的哦。
                </div>
            </div>
        </div>

        <!-- 上传区域 -->
        <div class="input-area">
            <label for="img-input" class="img-upload">
                <i class="fas fa-upload"></i> 选择截图（可单次/多次上传，共需4张）
            </label>
            <input type="file" id="img-input" accept="image/jpg,image/png,image/jpeg" multiple>
            <div class="upload-tip" id="uploadTip">已选择：0/4张</div>
            <div class="warning-tip" id="warningTip">⚠️ 不规范/重复截图，进度已重置！</div>
        </div>
    </div>

    <!-- 外部脚本引入 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="swiper.min.js"></script>
    <script src="simple-script.js"></script>

    <!-- 轮播初始化脚本 -->
    <script>
        // 第一组
        var swiper1 = new Swiper("#swiperGroup1", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 2500, disableOnInteraction: false},
            pagination: {el: "#swiperGroup1 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup1 .swiper-button-next", prevEl: "#swiperGroup1 .swiper-button-prev"},
        });

        // 第二组
        var swiper2 = new Swiper("#swiperGroup2", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 3000, disableOnInteraction: false},
            pagination: {el: "#swiperGroup2 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup2 .swiper-button-next", prevEl: "#swiperGroup2 .swiper-button-prev"},
        });

        // 第三组
        var swiper3 = new Swiper("#swiperGroup3", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 3500, disableOnInteraction: false},
            pagination: {el: "#swiperGroup3 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup3 .swiper-button-next", prevEl: "#swiperGroup3 .swiper-button-prev"},
        });

        // 第四组
        var swiper4 = new Swiper("#swiperGroup4", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 4000, disableOnInteraction: false},
            pagination: {el: "#swiperGroup4 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup4 .swiper-button-next", prevEl: "#swiperGroup4 .swiper-button-prev"},
        });
    </script>

    <!-- 3. 客服核心逻辑：单张上传进度回复 + 链接获取提示 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM元素
            const triggerBtn = document.getElementById('serviceTriggerBtn');
            const servicePopup = document.getElementById('servicePopup');
            const popupClose = document.getElementById('popupClose');
            const messageContainer = document.getElementById('messageContainer');
            const imgInput = document.getElementById('img-input');
            const uploadTip = document.getElementById('uploadTip');
            const warningTip = document.getElementById('warningTip');

            // 状态管理
            let uploadedKeys = []; // 防重复：文件名+大小
            let currentCount = 0;
            const needCount = 4; // 总需4张

            // 1. 弹窗控制
            triggerBtn.addEventListener('click', () => {
                servicePopup.style.display = 'flex';
                triggerBtn.style.display = 'none';
                messageContainer.scrollTop = messageContainer.scrollHeight;
            });

            popupClose.addEventListener('click', () => {
                servicePopup.style.display = 'none';
                triggerBtn.style.display = 'flex';
            });

            // 2. 核心：单张上传进度回复
            imgInput.addEventListener('change', (e) => {
                const selectedFiles = Array.from(e.target.files);
                if (selectedFiles.length === 0) return;

                // 计算剩余可上传数量
                const remaining = needCount - currentCount;
                // 若单次上传超过剩余数量，只取前remaining张
                const validFiles = selectedFiles.slice(0, remaining);
                if (validFiles.length === 0) {
                    showWarning('已上传4张，无需再传');
                    return;
                }

                // 检测重复/不规范
                let hasDuplicate = false;
                let hasInvalid = false;
                const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];
                
                validFiles.forEach(file => {
                    const key = `${file.name}-${file.size}`;
                    if (uploadedKeys.includes(key)) hasDuplicate = true;
                    if (!validTypes.includes(file.type) || file.size < 10240) hasInvalid = true;
                });

                // 违规处理：重置进度
                if (hasDuplicate || hasInvalid) {
                    const tip = hasDuplicate ? '包含重复截图' : '包含不规范截图（非图片/过小）';
                    showWarning(tip);
                    resetProgress();
                    return;
                }

                // 合规处理：更新进度+显示用户图片+客服进度回复
                hideWarning();
                validFiles.forEach(file => {
                    uploadedKeys.push(`${file.name}-${file.size}`);
                });
                // 计算新进度
                const newCount = currentCount + validFiles.length;
                const newRemaining = needCount - newCount;

                // 2.1 显示用户上传的图片
                showUserImages(validFiles);

                // 2.2 客服实时进度回复（每张对应一条回复）
                validFiles.forEach((_, index) => {
                    const currentStep = currentCount + index + 1;
                    const stepRemaining = needCount - currentStep;
                    setTimeout(() => {
                        showServiceReply(`
                            图片上传成功，审核通过！当前已上传 ${currentStep} 张图片，请继续上传剩余 ${stepRemaining} 张图片。
                        `);
                    }, index * 500); // 每张间隔0.5秒，避免回复重叠
                });

                // 2.3 更新进度状态
                currentCount = newCount;
                uploadTip.textContent = `已选择：${currentCount}/${needCount}张`;

                // 2.4 若传满4张：先提示“获取链接中”，再显示最终回复
                if (currentCount === needCount) {
                    setTimeout(() => {
                        // 第一步：显示“正在获取链接”
                        showServiceReply('正在获取游戏链接，请稍候...');
                        // 第二步：2秒后显示最终链接回复
                        setTimeout(() => {
                            showServiceReply(`
                                ✅ 宝子恭喜你获得资源（一共有3个获取入口，如果其中一个和谐或者没有想看的就换一个渠道）
                                速度保存到自己网盘，因为链接随时失效，3个渠道建议全部保存到自己的网盘，因为每个网盘的资源都不一样。
                                <br><br>
                                1. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">热门吃瓜入口</a><br>
                                2. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">反差女神入口</a><br>
                                3. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">绅士游戏入口</a>
                            `);
                            // 5秒后重置进度，允许重新上传
                            setTimeout(resetProgress, 5000);
                        }, 2000);
                    }, validFiles.length * 500); // 等所有进度回复完成后再触发
                }

                imgInput.value = '';
            });

            // 辅助函数：显示用户上传图片
            function showUserImages(files) {
                const userRow = document.createElement('div');
                userRow.className = 'message-row user-message-row';

                const userBubble = document.createElement('div');
                userBubble.className = 'message-bubble user-bubble';
                userBubble.textContent = `我上传了${files.length}张截图：`;

                const imgContainer = document.createElement('div');
                imgContainer.className = 'user-images';
                files.forEach(file => {
                    const img = document.createElement('img');
                    img.src = URL.createObjectURL(file);
                    img.alt = `用户截图${currentCount + imgContainer.children.length + 1}`;
                    imgContainer.appendChild(img);
                });

                userRow.appendChild(userBubble);
                messageContainer.appendChild(userRow);
                messageContainer.appendChild(imgContainer);
                messageContainer.scrollTop = messageContainer.scrollHeight;
            }

            // 辅助函数：显示小雨回复（带b1.png头像）
            function showServiceReply(content) {
                const serviceRow = document.createElement('div');
                serviceRow.className = 'message-row service-message-row';

                const serviceAvatar = document.createElement('img');
                serviceAvatar.src = 'b1.png';
                serviceAvatar.alt = '小雨头像';
                serviceAvatar.className = 'service-avatar-img';

                const serviceBubble = document.createElement('div');
                serviceBubble.className = 'message-bubble service-bubble';
                serviceBubble.innerHTML = content;

                serviceRow.appendChild(serviceAvatar);
                serviceRow.appendChild(serviceBubble);
                messageContainer.appendChild(serviceRow);
                messageContainer.scrollTop = messageContainer.scrollHeight;
            }

            // 辅助函数：警告提示
            function showWarning(text) {
                warningTip.textContent = `⚠️ ${text}，进度已重置！`;
                warningTip.style.display = 'block';
                setTimeout(hideWarning, 3000);
            }

            function hideWarning() {
                warningTip.style.display = 'none';
            }

            // 辅助函数：重置进度
            function resetProgress() {
                uploadedKeys = [];
                currentCount = 0;
                uploadTip.textContent = `已选择：0/${needCount}张`;
                imgInput.value = '';
                // 可选：添加进度重置的客服提示
                showServiceReply('进度已重置，请重新上传合规的截图（共需4张）。');
            }
        });
    </script>
</body>
</html>