<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€çº¿åƒç“œç½‘</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="swiper.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- æ•´åˆæ‰€æœ‰æ ·å¼ï¼šé•¿æ¡è§¦å‘æŒ‰é’® + QQå¼èŠå¤© -->
    <style>
        /* åŸé¡µé¢è½®æ’­æ ·å¼ */
        .profile{
            position: relative; 
            overflow: hidden;
            border: 4px solid rgba(255,255,255,.3);
            border-radius: 10px;
        }
        .profile img{
            width: 100% !important;
            height: auto !important;
            display: block;
        }
        .profile .swiper-button-next,
        .profile .swiper-button-prev{
            color: #fff;
        }
        .swiper-button-next:after, 
        .swiper-button-prev:after{
            font-size: 20px;
        }
        .fgt{height: 20px;}
        .swiper{padding-bottom: 25px;}
        .main-link{
            width: 60%; 
            margin:10px auto;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            text-decoration: none;
        }
        .pr_wbnr h3{
            font-size: 12px; 
            line-height: 22px; 
            color: #333;
            text-align: left;
        }

        /* 1. AIæœºå™¨äººè§¦å‘æŒ‰é’®ï¼šé•¿æ¡å°æ¡†æ¡†æ ·å¼ */
        .service-trigger-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 120px; /* é•¿æ¡å®½åº¦ */
            height: 40px; /* é«˜åº¦ */
            background: #0084ff;
            border-radius: 6px; /* å°åœ†è§’ï¼Œéåœ†å½¢ */
            box-shadow: 0 2px 8px rgba(0,132,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            z-index: 9998;
            transition: all 0.3s;
            gap: 6px; /* å›¾æ ‡ä¸æ–‡å­—é—´è· */
        }
        .service-trigger-btn:hover {
            background: #0073e6;
            box-shadow: 0 3px 10px rgba(0,132,255,0.4);
        }
        .service-trigger-btn i {
            font-size: 16px; /* AIæœºå™¨äººå›¾æ ‡å¤§å° */
        }

        /* 2. å®¢æœå¼¹çª— */
        .service-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 380px;
            border: 1px solid #eee;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background: #fff;
            overflow: hidden;
            font-family: "Microsoft YaHei", sans-serif;
            display: none;
            z-index: 9999;
            flex-direction: column;
        }

        /* 3. å¼¹çª—å¤´éƒ¨ */
        .popup-header {
            padding: 12px 16px;
            background: #f5f5f5;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-left {
            display: flex;
            align-items: center;
        }
        .service-name {
            font-weight: 600;
            color: #333;
            margin-right: 8px;
            font-size: 15px;
        }
        .online-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4cd964;
            margin-right: 4px;
            animation: blink 1.5s infinite;
        }
        .status-text {
            font-size: 12px;
            color: #666;
        }
        .popup-close {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #999;
            transition: all 0.2s;
        }
        .popup-close:hover {
            background: #f0f0f0;
            color: #333;
        }

        /* 4. QQå¼èŠå¤©å¸ƒå±€ */
        .message-container {
            height: 400px;
            padding: 16px;
            overflow-y: auto;
            background: #fafafa;
            flex: 1;
        }
        .message-row {
            margin-bottom: 16px;
            display: flex;
            clear: both;
        }
        .service-message-row {
            align-items: flex-start;
        }
        .user-message-row {
            flex-direction: row-reverse;
            align-items: flex-start;
        }

        /* å°é›¨å¤´åƒï¼ˆb1.pngï¼‰ */
        .service-avatar-img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
            border: 1px solid #eee;
        }
        .user-avatar-img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-left: 8px;
            border: 1px solid #eee;
            display: none;
        }

        /* æ¶ˆæ¯æ°”æ³¡ */
        .message-bubble {
            max-width: 75%;
            padding: 10px 14px;
            border-radius: 18px;
            line-height: 1.5;
            font-size: 14px;
            position: relative;
        }
        .service-bubble {
            background: #e5f3ff;
            color: #333;
            border-top-left-radius: 4px;
        }
        .service-bubble::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 6px solid #e5f3ff;
        }
        .user-bubble {
            background: #0084ff;
            color: #fff;
            border-top-right-radius: 4px;
        }
        .user-bubble::before {
            content: '';
            position: absolute;
            right: -6px;
            top: 10px;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-left: 6px solid #0084ff;
        }

        /* 5. ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ */
        .user-images {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
            max-width: 75%;
            margin-left: auto;
        }
        .user-images img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #eee;
        }

        /* 6. åº•éƒ¨ä¸Šä¼ åŒºåŸŸ */
        .input-area {
            padding: 12px 16px;
            border-top: 1px solid #eee;
            background: #fff;
        }
        .img-upload {
            display: inline-block;
            padding: 8px 16px;
            background: #0084ff;
            color: #fff;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }
        .img-upload:hover {
            background: #0073e6;
        }
        #img-input {
            display: none;
        }
        .upload-tip {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
            text-align: center;
        }
        .warning-tip {
            font-size: 12px;
            color: #ff4d4f;
            margin-top: 4px;
            text-align: center;
            display: none;
        }

        /* åœ¨çº¿çŠ¶æ€é—ªçƒåŠ¨ç”» */
        @keyframes blink {
            0%,100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- èƒŒæ™¯åŠ¨ç”» -->
        <div class="background-animation">
            <div class="floating-shape shape-1"></div>
            <div class="floating-shape shape-2"></div>
            <div class="floating-shape shape-3"></div>
            <div class="floating-shape"></div>
            <div class="floating-shape"></div>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <main class="profile-container">
            <div class="shimmer-line"></div>
            
            <!-- ä¸ªäººä¿¡æ¯åŒºåŸŸ -->
            <section class="profile-header">
                <div class="avatar-container">
                    <img src="Tx.jpg" alt="å¤´åƒ" class="avatar" id="avatarImg">
                    <div class="avatar-border"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-dot"></div>
                    <div class="admin-secret-entry" id="adminSecretEntry">
                        <i class="fas fa-cog"></i>
                    </div>
                </div>
                
                <h1 class="profile-name" id="profileName">www.636.icu</h1>
                <p class="profile-bio" id="profileBio" style="font-size: 28px; color: #fff;">ä¸€çº¿åƒç“œç½‘</p>

                <!-- ç¬¬ä¸€ç»„è½®æ’­ï¼ˆa1-a5ï¼‰ -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup1">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a1.png" style="width: 100%;" alt="ç¬¬ä¸€ç»„å›¾1"/></div>
                            <div class="swiper-slide"><img src="a2.png" style="width: 100%;" alt="ç¬¬ä¸€ç»„å›¾2"/></div>
                            <div class="swiper-slide"><img src="a3.png" style="width: 100%;" alt="ç¬¬ä¸€ç»„å›¾3"/></div>
                            <div class="swiper-slide"><img src="a4.png" style="width: 100%;" alt="ç¬¬ä¸€ç»„å›¾4"/></div>
                            <div class="swiper-slide"><img src="a5.png" style="width: 100%;" alt="ç¬¬ä¸€ç»„å›¾5"/></div>
                        </div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-1" data-analytics="å®˜ç½‘">
                            <span class="watermelon-icon">ğŸ‰</span>
                            <span>çƒ­é—¨åƒç“œ</span>
                            <b>è·å–<br />èµ„æº</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- ç¬¬äºŒç»„è½®æ’­ï¼ˆa6-a10ï¼‰ -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup2">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a6.png" style="width: 100%;" alt="ç¬¬äºŒç»„å›¾1"/></div>
                            <div class="swiper-slide"><img src="a7.png" style="width: 100%;" alt="ç¬¬äºŒç»„å›¾2"/></div>
                            <div class="swiper-slide"><img src="a8.png" style="width: 100%;" alt="ç¬¬äºŒç»„å›¾3"/></div>
                            <div class="swiper-slide"><img src="a9.png" style="width: 100%;" alt="ç¬¬äºŒç»„å›¾4"/></div>
                            <div class="swiper-slide"><img src="a10.png" style="width: 100%;" alt="ç¬¬äºŒç»„å›¾5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-2" data-analytics="ä½œå“é›†">
                            <i class="fas fa-cloud"></i>
                            <span>åå·®å¥³ç¥</span>
                            <b>è·å–<br />èµ„æº</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- ç¬¬ä¸‰ç»„è½®æ’­ï¼ˆa11-a15ï¼‰ -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup3">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a11.png" style="width: 100%;" alt="ç¬¬ä¸‰ç»„å›¾1"/></div>
                            <div class="swiper-slide"><img src="a12.png" style="width: 100%;" alt="ç¬¬ä¸‰ç»„å›¾2"/></div>
                            <div class="swiper-slide"><img src="a13.png" style="width: 100%;" alt="ç¬¬ä¸‰ç»„å›¾3"/></div>
                            <div class="swiper-slide"><img src="a14.png" style="width: 100%;" alt="ç¬¬ä¸‰ç»„å›¾4"/></div>
                            <div class="swiper-slide"><img src="a15.png" style="width: 100%;" alt="ç¬¬ä¸‰ç»„å›¾5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-3" data-analytics="åšå®¢">
                            <span class="penguin-icon">ğŸ§­</span>
                            <span>silk/å¥³æ€§å‘</span>
                            <b>è·å–<br />èµ„æº</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
                <div class="fgt"></div>

                <!-- ç¬¬å››ç»„è½®æ’­ï¼ˆa16-a20ï¼‰ -->
                <div class="profile">
                    <div class="swiper mySwiper" id="swiperGroup4">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="a16.png" style="width: 100%;" alt="ç¬¬å››ç»„å›¾1"/></div>
                            <div class="swiper-slide"><img src="a17.png" style="width: 100%;" alt="ç¬¬å››ç»„å›¾2"/></div>
                            <div class="swiper-slide"><img src="a18.png" style="width: 100%;" alt="ç¬¬å››ç»„å›¾3"/></div>
                            <div class="swiper-slide"><img src="a19.png" style="width: 100%;" alt="ç¬¬å››ç»„å›¾4"/></div>
                            <div class="swiper-slide"><img src="a20.png" style="width: 100%;" alt="ç¬¬å››ç»„å›¾5"/></div>
                        </div>
                        <a href="https://f.wps.cn/g/mVSCm5ZJ/" class="main-link gradient-4" data-analytics="å¾€æœŸ">
                            <i class="fas fa-history"></i>
                            <span>ç»…å£«æ¸¸æˆ</span>
                            <b>è·å–<br />èµ„æº</b> 
                            <i class="fas fa-arrow-right arrow"></i>
                        </a>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>
            </section>

            <!-- äºŒç»´ç åŒºåŸŸ -->
            <section class="qr-section">
                <div class="qr-container">
                    <p class="qr-text">ä¸€çº¿åƒç“œç½‘</p>
                    <div class="pr_wbnr">
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">ä¸€çº¿åƒç“œç½‘æ”»å…‹å„ç§èµ„æºéš¾é¢˜ï¼Œå¸¦æ¥æœ€æ–°æœ€å¿«æœ€å…¨çš„åƒç“œé»‘æ–™å•Šå•Šå•Šå•Š</h3>	
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">æ˜æ˜Ÿã€ç½‘çº¢ã€å¥³ç¥ã€æ ¡å›­â€¦â€¦â€¦â€¦</h3>	
                        <h3 style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap;">è®©æ‚¨ä¸é”™è¿‡ä»»ä½•ä¸€ä¸ªçƒ­é—¨å¤§ç“œ</h3>	
                        <p style="text-align: right; color: #ff0000;font-weight: bold; font-size: 12px; margin-top: 10px;">éæ³•å¾‹å…è®¸åœ°åŒºä»¥åŠ18å²ä»¥ä¸‹ç”¨æˆ·ç¦æ­¢è®¿é—®ï¼</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- å·²åˆ é™¤ï¼šåº•éƒ¨å·¥å…·æ çš„åˆ†äº«æŒ‰é’® -->

        <!-- å·²åˆ é™¤ï¼šåˆ†äº«æ¨¡æ€æ¡† -->
    </div>

    <!-- 1. AIæœºå™¨äººè§¦å‘æŒ‰é’®ï¼šé•¿æ¡æ ·å¼ï¼ˆå›¾æ ‡+æ–‡å­—ï¼‰ -->
    <div class="service-trigger-btn" id="serviceTriggerBtn">
        <i class="fas fa-robot"></i> <!-- AIæœºå™¨äººå›¾æ ‡ -->
        <span>AIæœºå™¨äºº</span> <!-- æ–‡å­— -->
    </div>

    <!-- 2. å°é›¨å®¢æœå¼¹çª— -->
    <div class="service-popup" id="servicePopup">
        <!-- å¼¹çª—å¤´éƒ¨ -->
        <div class="popup-header">
            <div class="header-left">
                <div class="service-name">å°é›¨</div>
                <div class="online-status"></div>
                <div class="status-text">åœ¨çº¿ä¸­</div>
            </div>
            <div class="popup-close" id="popupClose">
                <i class="fas fa-times"></i>
            </div>
        </div>

        <!-- æ¶ˆæ¯åŒºåŸŸï¼šåˆå§‹å°é›¨å¯¹è¯ï¼ˆå¸¦b1.pngå¤´åƒï¼‰ -->
        <div class="message-container" id="messageContainer">
            <div class="message-row service-message-row">
                <img src="b1.png" alt="å°é›¨å¤´åƒ" class="service-avatar-img">
                <div class="message-bubble service-bubble">
                    è¯·å°†è¯„è®ºçš„è§„èŒƒæˆªå›¾éƒ½å‘é€ç»™æˆ‘ï¼Œå®¡æ ¸é€šè¿‡åæˆ‘ä¼šå‘é€æ‰€æœ‰èµ„æºçš„è·³è½¬é¡µé“¾æ¥~<br>
                    æ³¨æ„ï¼šä¸è§„èŒƒæˆªå›¾å’Œå‘é€é‡å¤çš„æˆªå›¾å°†é‡ç½®è¿›åº¦ï¼Œæ‰€ä»¥æ˜¯ä¸€å®šä¸èƒ½æŠ•æœºå–å·§çš„å“¦ã€‚
                </div>
            </div>
        </div>

        <!-- ä¸Šä¼ åŒºåŸŸ -->
        <div class="input-area">
            <label for="img-input" class="img-upload">
                <i class="fas fa-upload"></i> é€‰æ‹©æˆªå›¾ï¼ˆå¯å•æ¬¡/å¤šæ¬¡ä¸Šä¼ ï¼Œå…±éœ€4å¼ ï¼‰
            </label>
            <input type="file" id="img-input" accept="image/jpg,image/png,image/jpeg" multiple>
            <div class="upload-tip" id="uploadTip">å·²é€‰æ‹©ï¼š0/4å¼ </div>
            <div class="warning-tip" id="warningTip">âš ï¸ ä¸è§„èŒƒ/é‡å¤æˆªå›¾ï¼Œè¿›åº¦å·²é‡ç½®ï¼</div>
        </div>
    </div>

    <!-- å¤–éƒ¨è„šæœ¬å¼•å…¥ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="swiper.min.js"></script>
    <script src="simple-script.js"></script>

    <!-- è½®æ’­åˆå§‹åŒ–è„šæœ¬ -->
    <script>
        // ç¬¬ä¸€ç»„
        var swiper1 = new Swiper("#swiperGroup1", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 2500, disableOnInteraction: false},
            pagination: {el: "#swiperGroup1 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup1 .swiper-button-next", prevEl: "#swiperGroup1 .swiper-button-prev"},
        });

        // ç¬¬äºŒç»„
        var swiper2 = new Swiper("#swiperGroup2", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 3000, disableOnInteraction: false},
            pagination: {el: "#swiperGroup2 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup2 .swiper-button-next", prevEl: "#swiperGroup2 .swiper-button-prev"},
        });

        // ç¬¬ä¸‰ç»„
        var swiper3 = new Swiper("#swiperGroup3", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 3500, disableOnInteraction: false},
            pagination: {el: "#swiperGroup3 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup3 .swiper-button-next", prevEl: "#swiperGroup3 .swiper-button-prev"},
        });

        // ç¬¬å››ç»„
        var swiper4 = new Swiper("#swiperGroup4", {
            spaceBetween: 0,
            centeredSlides: true,
            loop:true,
            autoplay: {delay: 4000, disableOnInteraction: false},
            pagination: {el: "#swiperGroup4 .swiper-pagination", clickable: true},
            navigation: {nextEl: "#swiperGroup4 .swiper-button-next", prevEl: "#swiperGroup4 .swiper-button-prev"},
        });
    </script>

    <!-- 3. å®¢æœæ ¸å¿ƒé€»è¾‘ï¼šå•å¼ ä¸Šä¼ è¿›åº¦å›å¤ + é“¾æ¥è·å–æç¤º -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOMå…ƒç´ 
            const triggerBtn = document.getElementById('serviceTriggerBtn');
            const servicePopup = document.getElementById('servicePopup');
            const popupClose = document.getElementById('popupClose');
            const messageContainer = document.getElementById('messageContainer');
            const imgInput = document.getElementById('img-input');
            const uploadTip = document.getElementById('uploadTip');
            const warningTip = document.getElementById('warningTip');

            // çŠ¶æ€ç®¡ç†
            let uploadedKeys = []; // é˜²é‡å¤ï¼šæ–‡ä»¶å+å¤§å°
            let currentCount = 0;
            const needCount = 4; // æ€»éœ€4å¼ 

            // 1. å¼¹çª—æ§åˆ¶
            triggerBtn.addEventListener('click', () => {
                servicePopup.style.display = 'flex';
                triggerBtn.style.display = 'none';
                messageContainer.scrollTop = messageContainer.scrollHeight;
            });

            popupClose.addEventListener('click', () => {
                servicePopup.style.display = 'none';
                triggerBtn.style.display = 'flex';
            });

            // 2. æ ¸å¿ƒï¼šå•å¼ ä¸Šä¼ è¿›åº¦å›å¤
            imgInput.addEventListener('change', (e) => {
                const selectedFiles = Array.from(e.target.files);
                if (selectedFiles.length === 0) return;

                // è®¡ç®—å‰©ä½™å¯ä¸Šä¼ æ•°é‡
                const remaining = needCount - currentCount;
                // è‹¥å•æ¬¡ä¸Šä¼ è¶…è¿‡å‰©ä½™æ•°é‡ï¼Œåªå–å‰remainingå¼ 
                const validFiles = selectedFiles.slice(0, remaining);
                if (validFiles.length === 0) {
                    showWarning('å·²ä¸Šä¼ 4å¼ ï¼Œæ— éœ€å†ä¼ ');
                    return;
                }

                // æ£€æµ‹é‡å¤/ä¸è§„èŒƒ
                let hasDuplicate = false;
                let hasInvalid = false;
                const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];
                
                validFiles.forEach(file => {
                    const key = `${file.name}-${file.size}`;
                    if (uploadedKeys.includes(key)) hasDuplicate = true;
                    if (!validTypes.includes(file.type) || file.size < 10240) hasInvalid = true;
                });

                // è¿è§„å¤„ç†ï¼šé‡ç½®è¿›åº¦
                if (hasDuplicate || hasInvalid) {
                    const tip = hasDuplicate ? 'åŒ…å«é‡å¤æˆªå›¾' : 'åŒ…å«ä¸è§„èŒƒæˆªå›¾ï¼ˆéå›¾ç‰‡/è¿‡å°ï¼‰';
                    showWarning(tip);
                    resetProgress();
                    return;
                }

                // åˆè§„å¤„ç†ï¼šæ›´æ–°è¿›åº¦+æ˜¾ç¤ºç”¨æˆ·å›¾ç‰‡+å®¢æœè¿›åº¦å›å¤
                hideWarning();
                validFiles.forEach(file => {
                    uploadedKeys.push(`${file.name}-${file.size}`);
                });
                // è®¡ç®—æ–°è¿›åº¦
                const newCount = currentCount + validFiles.length;
                const newRemaining = needCount - newCount;

                // 2.1 æ˜¾ç¤ºç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
                showUserImages(validFiles);

                // 2.2 å®¢æœå®æ—¶è¿›åº¦å›å¤ï¼ˆæ¯å¼ å¯¹åº”ä¸€æ¡å›å¤ï¼‰
                validFiles.forEach((_, index) => {
                    const currentStep = currentCount + index + 1;
                    const stepRemaining = needCount - currentStep;
                    setTimeout(() => {
                        showServiceReply(`
                            å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼Œå®¡æ ¸é€šè¿‡ï¼å½“å‰å·²ä¸Šä¼  ${currentStep} å¼ å›¾ç‰‡ï¼Œè¯·ç»§ç»­ä¸Šä¼ å‰©ä½™ ${stepRemaining} å¼ å›¾ç‰‡ã€‚
                        `);
                    }, index * 500); // æ¯å¼ é—´éš”0.5ç§’ï¼Œé¿å…å›å¤é‡å 
                });

                // 2.3 æ›´æ–°è¿›åº¦çŠ¶æ€
                currentCount = newCount;
                uploadTip.textContent = `å·²é€‰æ‹©ï¼š${currentCount}/${needCount}å¼ `;

                // 2.4 è‹¥ä¼ æ»¡4å¼ ï¼šå…ˆæç¤ºâ€œè·å–é“¾æ¥ä¸­â€ï¼Œå†æ˜¾ç¤ºæœ€ç»ˆå›å¤
                if (currentCount === needCount) {
                    setTimeout(() => {
                        // ç¬¬ä¸€æ­¥ï¼šæ˜¾ç¤ºâ€œæ­£åœ¨è·å–é“¾æ¥â€
                        showServiceReply('æ­£åœ¨è·å–æ¸¸æˆé“¾æ¥ï¼Œè¯·ç¨å€™...');
                        // ç¬¬äºŒæ­¥ï¼š2ç§’åæ˜¾ç¤ºæœ€ç»ˆé“¾æ¥å›å¤
                        setTimeout(() => {
                            showServiceReply(`
                                âœ… å®å­æ­å–œä½ è·å¾—èµ„æºï¼ˆä¸€å…±æœ‰3ä¸ªè·å–å…¥å£ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå’Œè°æˆ–è€…æ²¡æœ‰æƒ³çœ‹çš„å°±æ¢ä¸€ä¸ªæ¸ é“ï¼‰
                                é€Ÿåº¦ä¿å­˜åˆ°è‡ªå·±ç½‘ç›˜ï¼Œå› ä¸ºé“¾æ¥éšæ—¶å¤±æ•ˆï¼Œ3ä¸ªæ¸ é“å»ºè®®å…¨éƒ¨ä¿å­˜åˆ°è‡ªå·±çš„ç½‘ç›˜ï¼Œå› ä¸ºæ¯ä¸ªç½‘ç›˜çš„èµ„æºéƒ½ä¸ä¸€æ ·ã€‚
                                <br><br>
                                1. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">çƒ­é—¨åƒç“œå…¥å£</a><br>
                                2. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">åå·®å¥³ç¥å…¥å£</a><br>
                                3. <a href="https://f.wps.cn/g/mVSCm5ZJ/" target="_blank" style="color:#0084ff; text-decoration:underline;">ç»…å£«æ¸¸æˆå…¥å£</a>
                            `);
                            // 5ç§’åé‡ç½®è¿›åº¦ï¼Œå…è®¸é‡æ–°ä¸Šä¼ 
                            setTimeout(resetProgress, 5000);
                        }, 2000);
                    }, validFiles.length * 500); // ç­‰æ‰€æœ‰è¿›åº¦å›å¤å®Œæˆåå†è§¦å‘
                }

                imgInput.value = '';
            });

            // è¾…åŠ©å‡½æ•°ï¼šæ˜¾ç¤ºç”¨æˆ·ä¸Šä¼ å›¾ç‰‡
            function showUserImages(files) {
                const userRow = document.createElement('div');
                userRow.className = 'message-row user-message-row';

                const userBubble = document.createElement('div');
                userBubble.className = 'message-bubble user-bubble';
                userBubble.textContent = `æˆ‘ä¸Šä¼ äº†${files.length}å¼ æˆªå›¾ï¼š`;

                const imgContainer = document.createElement('div');
                imgContainer.className = 'user-images';
                files.forEach(file => {
                    const img = document.createElement('img');
                    img.src = URL.createObjectURL(file);
                    img.alt = `ç”¨æˆ·æˆªå›¾${currentCount + imgContainer.children.length + 1}`;
                    imgContainer.appendChild(img);
                });

                userRow.appendChild(userBubble);
                messageContainer.appendChild(userRow);
                messageContainer.appendChild(imgContainer);
                messageContainer.scrollTop = messageContainer.scrollHeight;
            }

            // è¾…åŠ©å‡½æ•°ï¼šæ˜¾ç¤ºå°é›¨å›å¤ï¼ˆå¸¦b1.pngå¤´åƒï¼‰
            function showServiceReply(content) {
                const serviceRow = document.createElement('div');
                serviceRow.className = 'message-row service-message-row';

                const serviceAvatar = document.createElement('img');
                serviceAvatar.src = 'b1.png';
                serviceAvatar.alt = 'å°é›¨å¤´åƒ';
                serviceAvatar.className = 'service-avatar-img';

                const serviceBubble = document.createElement('div');
                serviceBubble.className = 'message-bubble service-bubble';
                serviceBubble.innerHTML = content;

                serviceRow.appendChild(serviceAvatar);
                serviceRow.appendChild(serviceBubble);
                messageContainer.appendChild(serviceRow);
                messageContainer.scrollTop = messageContainer.scrollHeight;
            }

            // è¾…åŠ©å‡½æ•°ï¼šè­¦å‘Šæç¤º
            function showWarning(text) {
                warningTip.textContent = `âš ï¸ ${text}ï¼Œè¿›åº¦å·²é‡ç½®ï¼`;
                warningTip.style.display = 'block';
                setTimeout(hideWarning, 3000);
            }

            function hideWarning() {
                warningTip.style.display = 'none';
            }

            // è¾…åŠ©å‡½æ•°ï¼šé‡ç½®è¿›åº¦
            function resetProgress() {
                uploadedKeys = [];
                currentCount = 0;
                uploadTip.textContent = `å·²é€‰æ‹©ï¼š0/${needCount}å¼ `;
                imgInput.value = '';
                // å¯é€‰ï¼šæ·»åŠ è¿›åº¦é‡ç½®çš„å®¢æœæç¤º
                showServiceReply('è¿›åº¦å·²é‡ç½®ï¼Œè¯·é‡æ–°ä¸Šä¼ åˆè§„çš„æˆªå›¾ï¼ˆå…±éœ€4å¼ ï¼‰ã€‚');
            }
        });
    </script>
</body>
</html>